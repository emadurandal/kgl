parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"q3Og":[function(require,module,exports) {
"use strict";function t(){return r(new Float32Array(16))}function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function e(t,r,e){var n=t[0],o=t[1],u=t[2],a=t[3],s=t[4],i=t[5],c=t[6],p=t[7],f=t[8],x=t[9],l=t[10],v=t[11],h=t[12],M=t[13],d=t[14],q=t[15],y=r[0],m=r[1],g=r[2],A=r[3],P=r[4],S=r[5],_=r[6],b=r[7],j=r[8],k=r[9],w=r[10],z=r[11],F=r[12],I=r[13],L=r[14],O=r[15];return e[0]=y*n+m*s+g*f+A*h,e[1]=y*o+m*i+g*x+A*M,e[2]=y*u+m*c+g*l+A*d,e[3]=y*a+m*p+g*v+A*q,e[4]=P*n+S*s+_*f+b*h,e[5]=P*o+S*i+_*x+b*M,e[6]=P*u+S*c+_*l+b*d,e[7]=P*a+S*p+_*v+b*q,e[8]=j*n+k*s+w*f+z*h,e[9]=j*o+k*i+w*x+z*M,e[10]=j*u+k*c+w*l+z*d,e[11]=j*a+k*p+w*v+z*q,e[12]=F*n+I*s+L*f+O*h,e[13]=F*o+I*i+L*x+O*M,e[14]=F*u+I*c+L*l+O*d,e[15]=F*a+I*p+L*v+O*q,e}function n(t,r,e){return e[0]=t[0]*r[0],e[1]=t[1]*r[0],e[2]=t[2]*r[0],e[3]=t[3]*r[0],e[4]=t[4]*r[1],e[5]=t[5]*r[1],e[6]=t[6]*r[1],e[7]=t[7]*r[1],e[8]=t[8]*r[2],e[9]=t[9]*r[2],e[10]=t[10]*r[2],e[11]=t[11]*r[2],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(t,r,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12],e[13]=t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13],e[14]=t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14],e[15]=t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15],e}function u(t,r,e,n){var o=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);if(!o)return null;var u=e[0],a=e[1],s=e[2];1!==o&&(u*=o=1/o,a*=o,s*=o);var i=Math.sin(r),c=Math.cos(r),p=1-c,f=t[0],x=t[1],l=t[2],v=t[3],h=t[4],M=t[5],d=t[6],q=t[7],y=t[8],m=t[9],g=t[10],A=t[11],P=u*u*p+c,S=a*u*p+s*i,_=s*u*p-a*i,b=u*a*p-s*i,j=a*a*p+c,k=s*a*p+u*i,w=u*s*p+a*i,z=a*s*p-u*i,F=s*s*p+c;return r?t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]):n=t,n[0]=f*P+h*S+y*_,n[1]=x*P+M*S+m*_,n[2]=l*P+d*S+g*_,n[3]=v*P+q*S+A*_,n[4]=f*b+h*j+y*k,n[5]=x*b+M*j+m*k,n[6]=l*b+d*j+g*k,n[7]=v*b+q*j+A*k,n[8]=f*w+h*z+y*F,n[9]=x*w+M*z+m*F,n[10]=l*w+d*z+g*F,n[11]=v*w+q*z+A*F,n}function a(t,e,n,o){var u,a,s,i,c,p,f,x,l,v,h=t[0],M=t[1],d=t[2],q=n[0],y=n[1],m=n[2],g=e[0],A=e[1],P=e[2];return h===g&&M===A&&d===P?r(o):(f=h-e[0],x=M-e[1],l=d-e[2],u=y*(l*=v=1/Math.sqrt(f*f+x*x+l*l))-m*(x*=v),a=m*(f*=v)-q*l,s=q*x-y*f,(v=Math.sqrt(u*u+a*a+s*s))?(u*=v=1/v,a*=v,s*=v):(u=0,a=0,s=0),i=x*s-l*a,c=l*u-f*s,p=f*a-x*u,(v=Math.sqrt(i*i+c*c+p*p))?(i*=v=1/v,c*=v,p*=v):(i=0,c=0,p=0),o[0]=u,o[1]=i,o[2]=f,o[3]=0,o[4]=a,o[5]=c,o[6]=x,o[7]=0,o[8]=s,o[9]=p,o[10]=l,o[11]=0,o[12]=-(u*h+a*M+s*d),o[13]=-(i*h+c*M+p*d),o[14]=-(f*h+x*M+l*d),o[15]=1,o)}function s(t,r,e,n,o){var u=e*Math.tan(t*Math.PI/360),a=2*(u*r),s=2*u,i=n-e;return o[0]=2*e/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*e/s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-(n+e)/i,o[11]=-1,o[12]=0,o[13]=0,o[14]=-n*e*2/i,o[15]=0,o}function i(t,r,e,n,o,u,a){var s=r-t,i=e-n,c=u-o;return a[0]=2/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2/c,a[11]=0,a[12]=-(t+r)/s,a[13]=-(e+n)/i,a[14]=-(u+o)/c,a[15]=1,a}function c(t,r){return r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15],r}function p(t,r){var e=t[0],n=t[1],o=t[2],u=t[3],a=t[4],s=t[5],i=t[6],c=t[7],p=t[8],f=t[9],x=t[10],l=t[11],v=t[12],h=t[13],M=t[14],d=t[15],q=e*s-n*a,y=e*i-o*a,m=e*c-u*a,g=n*i-o*s,A=n*c-u*s,P=o*c-u*i,S=p*h-f*v,_=p*M-x*v,b=p*d-l*v,j=f*M-x*h,k=f*d-l*h,w=x*d-l*M,z=1/(q*w-y*k+m*j+g*b-A*_+P*S);return r[0]=(s*w-i*k+c*j)*z,r[1]=(-n*w+o*k-u*j)*z,r[2]=(h*P-M*A+d*g)*z,r[3]=(-f*P+x*A-l*g)*z,r[4]=(-a*w+i*b-c*_)*z,r[5]=(e*w-o*b+u*_)*z,r[6]=(-v*P+M*m-d*y)*z,r[7]=(p*P-x*m+l*y)*z,r[8]=(a*k-s*b+c*S)*z,r[9]=(-e*k+n*b-u*S)*z,r[10]=(v*A-h*m+d*q)*z,r[11]=(-p*A+f*m-l*q)*z,r[12]=(-a*j+s*_-i*S)*z,r[13]=(e*j-n*_+o*S)*z,r[14]=(-v*g+h*y-M*q)*z,r[15]=(p*g-f*y+x*q)*z,r}function f(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function x(t,r){return v(t,f(t)||1)}function l(t,r){return t[0]*=r,t[1]*=r,t[2]*=r,t}function v(t,r){return l(t,1/r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMatrix=t,exports.divideScalar=v,exports.getLength=f,exports.identity=r,exports.inverse=p,exports.lookAt=a,exports.multiply=e,exports.multiplyScalar=l,exports.normalize=x,exports.ortho=i,exports.perspective=s,exports.rotate=u,exports.scale=n,exports.translate=o,exports.transpose=c;
},{}],"TeiP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./minMatrix.js");function e(t){return s(t)||r(t)||a(t)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function r(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function s(t){if(Array.isArray(t))return n(t)}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function c(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}var l=function(){function i(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h(this,i),this.isProgram=!1,this.children=[],this.kgl=e,this.hasMatrix=!("hasMatrix"in a)||a.hasMatrix,this.hasMatrix&&(this.mMatrix=(0,t.createMatrix)(),this.mvpMatrix=(0,t.createMatrix)(),this._translate=[0,0,0],this._scale=[1,1,1],this._rotate=[0,0,0],this.isUpdateMatrix=!1,"x"in a&&(this.x=a.x),"y"in a&&(this.y=a.y),"z"in a&&(this.z=a.z),"translate3d"in a&&(this.translate3d=a.translate3d),"scale"in a&&(this.scale=a.scale),"scaleX"in a&&(this.scaleX=a.scaleX),"scaleY"in a&&(this.scaleY=a.scaleY),"scaleZ"in a&&(this.scaleZ=a.scaleZ),"scale3d"in a&&(this.scale3d=a.scale3d),"rotateX"in a&&(this.rotateX=a.rotateX),"rotateY"in a&&(this.rotateY=a.rotateY),"rotateZ"in a&&(this.rotateZ=a.rotateZ),"rotate"in a&&(this.rotate=a.rotate),"rotate3d"in a&&(this.rotate3d=a.rotate3d))}return c(i,[{key:"x",get:function(){return this._translate[0]},set:function(t){this._translate[0]=t,this.changeMatrix()}},{key:"y",get:function(){return this._translate[1]},set:function(t){this._translate[1]=t,this.changeMatrix()}},{key:"z",get:function(){return this._translate[2]},set:function(t){this._translate[2]=t,this.changeMatrix()}},{key:"translate3d",get:function(){return e(this._translate)},set:function(t){this._translate[0]=t[0],this._translate[1]=t[1],this._translate[2]=t[2],this.changeMatrix()}},{key:"scale",get:function(){return this._scale[0]===this._scale[1]&&this._scale[0]===this._scale[2]?this._scale[0]:null},set:function(t){this._scale[0]=this._scale[1]=this._scale[2]=t,this.changeMatrix()}},{key:"scaleX",get:function(){return this._scale[0]},set:function(t){this._scale[0]=t,this.changeMatrix()}},{key:"scaleY",get:function(){return this._scale[1]},set:function(t){this._scale[1]=t,this.changeMatrix()}},{key:"scaleZ",get:function(){return this._scale[2]},set:function(t){this._scale[2]=t,this.changeMatrix()}},{key:"scale3d",get:function(){return e(this._scale)},set:function(t){this._scale[0]=t[0],this._scale[1]=t[1],this._scale[2]=t[2],this.changeMatrix()}},{key:"rotateX",get:function(){return this._rotate[0]},set:function(t){this._rotate[0]=t,this.changeMatrix()}},{key:"rotateY",get:function(){return this._rotate[1]},set:function(t){this._rotate[1]=t,this.changeMatrix()}},{key:"rotateZ",get:function(){return this._rotate[2]},set:function(t){this._rotate[2]=t,this.changeMatrix()}},{key:"rotate",get:function(){return this.rotateZ},set:function(t){this.rotateZ=t}},{key:"rotate3d",get:function(){return e(this._rotate)},set:function(t){this._rotate[0]=t[0],this._rotate[1]=t[1],this._rotate[2]=t[2],this.changeMatrix()}},{key:"changeMatrix",value:function(){this.isUpdateMatrix||this.kgl.setIsUpdateMatrix()}},{key:"setIsUpdateMatrix",value:function(){if(this.hasMatrix&&(this.isUpdateMatrix=!0,!this.isProgram))for(var t=0;t<this.children.length;t=t+1|0)this.children[t].setIsUpdateMatrix()}},{key:"updateMatrix",value:function(e){if(this.hasMatrix){var i=this.isUpdateMatrix;if(i){if((0,t.identity)(this.mMatrix),(0,t.translate)(this.mMatrix,this._translate,this.mMatrix),(0,t.rotate)(this.mMatrix,this._rotate[0],[1,0,0],this.mMatrix),(0,t.rotate)(this.mMatrix,this._rotate[1],[0,1,0],this.mMatrix),(0,t.rotate)(this.mMatrix,this._rotate[2],[0,0,1],this.mMatrix),(0,t.scale)(this.mMatrix,[this._scale[0],this._scale[1],this._scale[2]],this.mMatrix),(0,t.multiply)(e,this.mMatrix,this.mvpMatrix),!this.isProgram)for(var a=0;a<this.children.length;a=a+1|0)this.children[a].updateMatrix(this.mvpMatrix);this.isUpdateMatrix=!1}return i}}},{key:"add",value:function(t){this.children.push(t)}},{key:"remove",value:function(t){var e=this;this.children.some(function(i,a){return i===t&&(e.children.splice(a,1),!0)})}},{key:"draw",value:function(){if(this.children.length>0)for(var t=0;t<this.children.length;t=t+1|0)this.children[t].draw()}},{key:"forEachProgram",value:function(t){if(this.isProgram)t(this);else for(var e=0;e<this.children.length;e=e+1|0)this.children[e].forEachProgram(t)}}]),i}();exports.default=l;
},{"./minMatrix.js":"q3Og"}],"XCtE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./object.js")),t=require("./minMatrix.js");function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=l(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}}).apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=p();return function(){var r,i=m(e);if(t){var a=m(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E={d2:"attribute vec2 aPosition;void main(){gl_Position=vec4(aPosition,0.,1.);}",d3:"\n    attribute vec3 aPosition;\n    attribute vec2 aUv;\n    uniform mat4 uMvpMatrix;\n    varying vec2 vUv;\n    void main() {\n      vUv = aUv;\n      gl_Position = uMvpMatrix * vec4(aPosition, 1.);\n    }\n  "},y={aPosition:{value:[-1,1,-1,-1,1,1,1,-1],size:2}};function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,r=void 0===t?1:t,i=e.height,a=void 0===i?1:i,n=e.hasLight,o=r/2,s=a/2,u={aPosition:{value:[-o,s,0,-o,-s,0,o,s,0,o,-s,0],size:3},aUv:{value:[0,1,0,0,1,1,1,0],size:2}};return void 0!==n&&n&&(u.aNormal={value:[0,1,0,0,1,0,0,1,0,0,1,0],size:3}),{attributes:u,resolution:[r,a]}}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size,r=void 0===t?1:t,i=e.hasLight,a=r/2,n={aPosition:{value:[a,a,-a,a,a,a,a,-a,a,a,-a,-a,-a,a,a,-a,a,-a,-a,-a,-a,-a,-a,a,-a,a,a,a,a,a,a,a,-a,-a,a,-a,-a,-a,-a,a,-a,-a,a,-a,a,-a,-a,a,a,a,a,-a,a,a,-a,-a,a,a,-a,a,-a,a,-a,a,a,-a,a,-a,-a,-a,-a,-a],size:3},indices:{value:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],isIndices:!0}};return void 0!==i&&i&&(n.aNormal={value:[1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],size:3}),{attributes:n,resolution:[r,r]}}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.radius,i=void 0===r?1:r,a=e.radiusTop,n=void 0===a?i:a,o=e.radiusBottom,s=void 0===o?i:o,u=e.height,c=void 0===u?1:u,h=e.radialSegments,l=void 0===h?8:h,d=e.heightSegments,f=void 0===d?1:d,v=e.openEnded,b=void 0===v||v,g=e.thetaStart,p=void 0===g?0:g,m=e.thetaLength,E=void 0===m?2*Math.PI:m,y=e.hasLight,A=void 0!==y&&y,x=[],T=[],R=[],_=[],P=0,S=[],O=c/2;function L(e){for(var t=P,r=!0===e?n:s,i=!0===e?1:-1,a=1;a<=l;a++)T.push(0,O*i,0),R.push(0,i,0),_.push(.5,.5),P++;for(var o=P,u=0;u<=l;u++){var c=u/l*E+p,h=Math.cos(c),d=Math.sin(c);T.push(r*d,O*i,r*h),R.push(0,i,0),_.push(.5*h+.5,.5*d*i+.5),P++}for(var f=0;f<l;f++){var v=t+f,b=o+f;!0===e?x.push(b,b+1,v):x.push(b+1,b,v)}}!function(){for(var e=(s-n)/c,r=0;r<=f;r++){for(var i=[],a=r/f,o=a*(s-n)+n,u=0;u<=l;u++){var h=u/l,d=h*E+p,v=Math.sin(d),b=Math.cos(d);if(T.push(o*v,-a*c+O,o*b),A){var g=[v,e,b];(0,t.normalize)(g),R.push(g[0],g[1],g[2])}_.push(h,1-a),i.push(P++)}S.push(i)}for(var m=0;m<l;m++)for(var y=0;y<f;y++){var L=S[y][m],M=S[y+1][m],I=S[y+1][m+1],k=S[y][m+1];x.push(L,M,k),x.push(M,I,k)}}(),!1===b&&(n>0&&L(!0),s>0&&L(!1));var M={aPosition:{value:T,size:3},aUv:{value:_,size:2},indices:{value:x,isIndices:!0}};return A&&(M.aNormal={value:R,size:3}),{attributes:M,resolution:[2*i*Math.PI,c]}}var R=function(r){d(o,e.default);var a=v(o);function o(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,o);var u=i.shape,c=i.vertexShaderId,h=i.vertexShader,l=void 0===h?c?document.getElementById(c).textContent:u?E.d3:E.d2:h,d=i.fragmentShaderId,f=i.fragmentShader,v=void 0===f?document.getElementById(d).textContent:f,g=i.attributes,p=i.instancedAttributes,m=i.uniforms,R=void 0===m?{}:m,_=i.mode,P=void 0===_?"point"===u?"POINTS":null:_,S=i.drawType,O=void 0===S?"STATIC_DRAW":S,L=i.isTransparent,M=void 0!==L&&L,I=i.isAdditive,k=void 0!==I&&I,w=i.isFloats,U=void 0!==w&&w,D=i.isCulling,C=void 0===D||D,j=i.isDepth,N=void 0!==j&&j,F=i.isAutoResolution,B=void 0===F?!U&&!R.uResolution:F,G=i.hasCamera,z=void 0===G?!U&&e.hasCamera:G,X=i.hasLight,H=void 0===X?!U&&e.hasLight:X;i.hasMatrix=z,(r=a.call(this,e,i)).isProgram=!0,r.attributes={},r.uniforms={},r.textures={};var Y=e.gl;r.gl=Y,e.indexProgram=e.indexProgram+1,r.id=e.indexProgram,H&&(r.invMatrix=(0,t.createMatrix)());var V=!(i.shape||i.vertexShaderId||i.vertexShader);if(r.mode=P,r.glMode=Y[P||"TRIANGLE_STRIP"],r.drawType=O,r.isTransparent=M,r.isAdditive=k,r.isAutoResolution=B,r.hasCamera=z,r.hasLight=H,r.isCulling=C,r.isDepth=N,r.isInstanced=p,r.createProgram(l,v),r.use(),V)r.createAttribute(y);else if(u&&"point"!==u){var W;switch(u){case"plane":W=A({hasLight:r.hasLight,width:i.width,height:i.height});break;case"cube":W=x({hasLight:r.hasLight,size:i.size});break;case"cylinder":W=T(n({hasLight:r.hasLight},i))}W&&(r.createAttribute(W.attributes),R.uResolutionShape=W.resolution)}else g&&r.createAttribute(g);if(r.isInstanced){if(r.instancedArraysExt=Y.getExtension("ANGLE_instanced_arrays"),null==r.instancedArraysExt)return alert("ANGLE_instanced_arrays not supported"),b(r);r.createAttribute(p,!0)}return r.createUniform(R),r}return c(o,[{key:"createProgram",value:function(e,t){var r=this.gl,i=r.createProgram();r.attachShader(i,this.vertexShader=this.createShader("VERTEX_SHADER",e)),r.attachShader(i,this.fragmentShader=this.createShader("FRAGMENT_SHADER",t)),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)?i?this.program=i:console.error("Failed to create program."):console.error(r.getProgramInfoLog(i))}},{key:"createShader",value:function(e,t){var r=this.gl,i=r.createShader(r[e]);if(r.shaderSource(i,t),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS))return i;console.error(r.getShaderInfoLog(i))}},{key:"createAttribute",value:function(e,t){var r=this;Object.keys(e).forEach(function(i){var a=e[i],n=a.value,o=a.size,s=a.isIndices;r.addAttribute(i,n,o,s,t)})}},{key:"addAttribute",value:function(e,t,r,i,a){var n=this.gl,o=n.getAttribLocation(this.program,e),s=this.attributes[e]={location:o,size:r,isInstanced:a};if(i){var u=n.createBuffer();n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,u),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Int16Array(t),n[this.drawType]),s.ibo=u,this.indicesCount=this.indicesCount||t.length,this.glMode=n[this.mode||"TRIANGLES"]}else{var c=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,c),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t),n[this.drawType]),s.vbo=c,a&&(this.instanceCount=this.instanceCount||t.length/r),this.count=this.count||t.length/r}}},{key:"setAttribute",value:function(e){var t=this.gl,r=this.attributes[e],i=r.location,a=r.size,n=r.vbo,o=r.ibo,s=r.isInstanced;o?t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o):(t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,a,t.FLOAT,!1,0,0),s&&this.instancedArraysExt.vertexAttribDivisorANGLE(i,1))}},{key:"updateAttribute",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,this.attributes[e].vbo),i.bufferSubData(i.ARRAY_BUFFER,r,new Float32Array(t))}},{key:"updateMatrix",value:function(e){this.hasMatrix&&(h(m(o.prototype),"updateMatrix",this).call(this,e)&&(this.hasCamera&&(this.uniforms.uMvpMatrix=this.mvpMatrix),this.hasLight&&((0,t.inverse)(this.mMatrix,this.invMatrix),this.uniforms.uInvMatrix=this.invMatrix)))}},{key:"createUniform",value:function(e){var t=this,r=Object.assign({},e);this.isAutoResolution&&!r.uResolution&&(r.uResolution=[1,1]),this.hasCamera&&(r.uMvpMatrix=new Float32Array(16)),this.hasLight&&(r.uInvMatrix=new Float32Array(16),r.uLightDirection||(r.uLightDirection=[0,0,0]),r.uEyeDirection||(r.uEyeDirection=[0,0,0]),r.uAmbientColor||(r.uAmbientColor=[.1,.1,.1])),Object.keys(r).forEach(function(e){t.addUniform(e,r[e])})}},{key:"addUniform",value:function(e,t){var r,a,n=this,o=t,s=function(t,i){switch(t){case"texture":r="texture",a="1i",o=n.createTexture(e,n._dummyCanvas||(n._dummyCanvas=document.createElement("canvas")));break;case"framebuffer":r="framebuffer",a="1i",o=i;break;default:a=t,o=i}};switch(i(t)){case"number":a="1f";break;case"boolean":a="1i";break;case"string":s(t);break;case"object":switch(t.constructor.name){case"Float32Array":case"Array":switch(t.length){case 16:r="matrix",a="Matrix4fv";break;default:a="".concat(t.length,"fv")}break;case"HTMLImageElement":case"HTMLVideoElement":case"HTMLCanvasElement":r="texture",a="1i",o=this.createTexture(e,t);break;case"Object":s(t.type,t.value)}}if(a){var u,c=this.gl.getUniformLocation(this.program,e),h="uniform".concat(a);switch(r){case"texture":u=function(t){switch(n.use(),i(t)){case"number":n.gl[h](c,t),o=t;break;case"string":o=n.textures[t].textureIndex,n.gl[h](c,o);break;default:o=n.updateTexture(e,t)}};break;case"framebuffer":u=function(e){n.use(),n.gl[h](c,n.kgl.framebuffers[e].textureIndex),o=e};break;case"matrix":u=function(e){n.use(),n.gl[h](c,!1,e),o=e};break;default:u=function(e){n.use(),n.gl[h](c,e),o=e}}Object.defineProperty(this.uniforms,e,{get:function(){return o},set:u}),void 0!==o&&(this.uniforms[e]=o)}else console.error('Failed to add uniform "'.concat(e,'".'))}},{key:"updateUniforms",value:function(e){for(var t=Object.keys(e),r=0;r<t.length;r++){var i=t[r];this.uniforms[i]=e[i]}}},{key:"createTexture",value:function(e,t){if(t){var r=this.gl,i=r.createTexture(),a=++this.kgl.textureIndex;return this.textures[e]={texture:i,textureIndex:a},r.activeTexture(r["TEXTURE".concat(a)]),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),a}}},{key:"updateTexture",value:function(e,t){var r=this.gl,i=this.textures[e].textureIndex;return r.activeTexture(r["TEXTURE".concat(i)]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),i}},{key:"use",value:function(){this.id!==this.kgl.currentProgramId&&(this.gl.useProgram(this.program),this.kgl.currentProgramId=this.id)}},{key:"draw",value:function(){var e=this.gl;this.isUpdateMatrix&&this.kgl.updateMatrix(),this.use(),this.isTransparent?(e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)):this.isAdditive?(e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE)):e.disable(e.BLEND),this.isCulling?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.isDepth?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST);for(var t=Object.keys(this.attributes),r=0;r<t.length;r++)this.setAttribute(t[r]);this.isInstanced?this.indicesCount?this.instancedArraysExt.drawElementsInstancedANGLE(this.glMode,this.indicesCount,e.UNSIGNED_SHORT,0,this.instanceCount):this.instancedArraysExt.drawArraysInstancedANGLE(this.glMode,0,this.count,this.instanceCount):this.indicesCount?e.drawElements(this.glMode,this.indicesCount,e.UNSIGNED_SHORT,0):e.drawArrays(this.glMode,0,this.count)}},{key:"destroy",value:function(){var e=this,t=this.gl;t.deleteShader(this.vertexShader),t.deleteShader(this.fragmentShader),Object.keys(this.attributes).forEach(function(r){var i=e.attributes[r],a=i.vbo,n=i.ibo;t.deleteBuffer(a||n)}),Object.keys(this.textures).forEach(function(r){var i=e.textures[r].texture;t.deleteTexture(i)}),t.deleteProgram(this.program)}}]),o}();exports.default=R;
},{"./object.js":"TeiP","./minMatrix.js":"q3Og"}],"gecP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./minMatrix.js"),t=i(require("./object.js")),r=i(require("./program.js"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var f=function(){function i(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,i),this.root=new t.default(this),this.indexProgram=-1,this.currentProgramId=null,this.isUpdateMatrix=!1,this.effectList=[],this.framebuffers={},this.textureIndex=-1;var a=r.canvas,o=r.isClear,s=void 0!==o&&o,f=r.clearedColor,u=r.hasCamera,h=void 0!==u&&u,E=r.hasLight,c=void 0!==E&&E;if(this.isClear=s,this.clearedColor=f||[0,0,0,0],this.hasCamera=h,this.hasLight=c,h){var l=r.fov,d=void 0===l?50:l,R=r.near,v=void 0===R?.1:R,T=r.far,m=void 0===T?2e3:T,b=r.cameraPosition,F=void 0===b?[0,0,30]:b,x=r.cameraRotation,_=void 0===x?[0,0]:x,g=r.extraFar,U=void 0===g?1:g;this.vMatrix=(0,e.createMatrix)(),this.pMatrix=(0,e.createMatrix)(),this.vpMatrix=(0,e.createMatrix)(),this.fov=d,this.near=v,this.far=m,this.cameraPosition=F,this.cameraRotation=_,this.isAutoUpdateCameraPositionZ=!("cameraPosition"in r||"far"in r),this.extraFar=U}if(c){var p=r.lightDirection,y=void 0===p?[-1,1,1]:p,A=r.eyeDirection,M=void 0===A?this.cameraPosition:A,D=r.ambientColor,P=void 0===D?[.1,.1,.1]:D;this.lightDirection=y,this.eyeDirection=M,this.ambientColor=P}this._initWebgl(a)}return s(i,[{key:"_initWebgl",value:function(e){"string"==typeof e?this.canvas=document.querySelector(e):"object"===a(e)&&"HTMLCanvasElement"===e.constructor.name?this.canvas=e:(this.canvas=document.createElement("canvas"),this.canvas.style.display="block",this.canvas.style.width="100%",this.canvas.style.height="100%",document.body.appendChild(this.canvas));var t=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl");t.depthFunc(t.LEQUAL)}},{key:"add",value:function(e){this.root.add(e)}},{key:"remove",value:function(e){this.root.remove(e)}},{key:"createProgram",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new r.default(this,e);return e.isAutoAdd&&this.add(t),t}},{key:"createGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new t.default(this,e);return e.isAutoAdd&&this.add(r),r}},{key:"createEffect",value:function(e,t){var r=new e(this,t);return this.effectList.push(r),r}},{key:"createFramebuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.canvas.width,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.canvas.height,i=this.gl,a=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,a);var n=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,n),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,n);var o=i.createTexture(),s=++this.textureIndex;i.activeTexture(i["TEXTURE".concat(s)]),i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,o,0),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null),this.framebuffers[e]={framebuffer:a,textureIndex:s,texture:o,depthRenderBuffer:n}}},{key:"resizeFramebuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.canvas.width,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.canvas.height,i=this.gl,a=this.framebuffers[e],n=a.framebuffer,o=a.textureIndex,s=a.depthRenderBuffer;a.isFloat||(i.bindFramebuffer(i.FRAMEBUFFER,n),i.bindRenderbuffer(i.RENDERBUFFER,s),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),i.activeTexture(i["TEXTURE".concat(o)]),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.UNSIGNED_BYTE,null))}},{key:"createFramebufferFloat",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=this.gl,a=i.getExtension("OES_texture_float"),n=i.getExtension("OES_texture_half_float");if(a||n){var o=n?n.HALF_FLOAT_OES:i.FLOAT,s=i.createFramebuffer(),f=i.createTexture(),u=++this.textureIndex;i.bindFramebuffer(i.FRAMEBUFFER,s),i.activeTexture(i["TEXTURE".concat(u)]),i.bindTexture(i.TEXTURE_2D,f),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,o,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,f,0),i.bindFramebuffer(i.FRAMEBUFFER,null),this.framebuffers[e]={framebuffer:s,textureIndex:u,texture:f,isFloat:!0}}else console.error("float texture not support")}},{key:"bindFramebuffer",value:function(e){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e?this.framebuffers[e].framebuffer:null)}},{key:"unbindFramebuffer",value:function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"resize",value:function(){var e=this,t=this.gl,r=this.canvas.clientWidth,i=this.canvas.clientHeight;this.canvas.width=r,this.canvas.height=i,t.viewport(0,0,r,i),this.root.forEachProgram(function(e){e.isAutoResolution&&(e.uniforms.uResolution=[r,i])}),this.effectList.forEach(function(e){e.isAutoResolution&&(e.uniforms.uResolution=[r,i])}),Object.keys(this.framebuffers).forEach(function(t){e.resizeFramebuffer(t)}),this.hasCamera&&(this.aspect=r/i,this.updateCamera()),this.hasLight&&this.updateLight()}},{key:"setIsUpdateMatrix",value:function(){this.isUpdateMatrix=!0,this.root.setIsUpdateMatrix()}},{key:"updateCamera",value:function(){var t=this.cameraPosition,r=this.cameraRotation,i=this.vMatrix,a=this.pMatrix,n=this.vpMatrix;this.isAutoUpdateCameraPositionZ&&(t[2]=Math.min(this.canvas.width,this.canvas.height)/2/Math.tan(this.fov/2*(Math.PI/180)),this.far=t[2]+this.extraFar),this.hasLight&&(this.eyeDirection=t),(0,e.lookAt)(t,[t[0],t[1],0],[0,1,0],i),(0,e.perspective)(this.fov,this.aspect,this.near,this.far,a),r[0]=r[0]%(2*Math.PI),r[1]=r[1]%(2*Math.PI),(0,e.rotate)(i,r[0],[0,1,0],i),(0,e.rotate)(i,r[1],[-1,0,0],i),(0,e.multiply)(a,i,n),this.setIsUpdateMatrix()}},{key:"updateLight",value:function(){var e=this.lightDirection,t=this.eyeDirection,r=this.ambientColor;this.root.forEachProgram(function(i){i.hasLight&&(i.uniforms.uLightDirection=e,i.uniforms.uEyeDirection=t,i.uniforms.uAmbientColor=r)})}},{key:"updateMatrix",value:function(){this.isUpdateMatrix&&(this.root.updateMatrix(this.vpMatrix),this.isUpdateMatrix=!1)}},{key:"clear",value:function(){var e=this.gl;e.clearColor(this.clearedColor[0],this.clearedColor[1],this.clearedColor[2],this.clearedColor[3]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},{key:"draw",value:function(){this.isClear&&this.clear(),this.root.forEachProgram(function(e){e.draw()})}},{key:"destroy",value:function(){var e,t=this,r=this.gl;Object.keys(this.framebuffers).forEach(function(e){var i=t.framebuffers[e],a=i.framebuffer,n=i.texture,o=i.depthRenderBuffer;r.deleteFramebuffer(a),r.deleteTexture(n),o&&r.deleteRenderbuffer(o)}),this.root.forEachProgram(function(e){e.destroy()}),null===(e=r.getExtension("WEBGL_lose_context"))||void 0===e||e.loseContext()}}]),i}();exports.default=f;
},{"./minMatrix.js":"q3Og","./object.js":"TeiP","./program.js":"XCtE"}],"f5B0":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uTexture;\nuniform vec2 uResolution;\nuniform float uRadius;\nuniform bool uIsHorizontal;\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main () {\n  vec2 uv = gl_FragCoord.xy / uResolution;\n  vec2 direction = uIsHorizontal ? vec2(1., 0.) : vec2(0., 1.);\n  direction *= uRadius;\n  gl_FragColor = blur9(uTexture, uv, uResolution, direction);\n}\n";
},{}],"qTOb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("../program.js")),e=r(require("../shaders/postprocessing/blur.frag"));function r(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=c(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function c(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=h();return function(){var r,n=b(t);if(e){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(r){a(u,t.default);var n=s(u);function u(t){var r;o(this,u);var i={fragmentShader:e.default,uniforms:{uTexture:"framebuffer",uRadius:0,uIsHorizontal:!1},hasCamera:!1,hasLight:!1};return(r=n.call(this,t,i)).radius=.5,r}return i(u,[{key:"draw",value:function(t,e,r,n){for(var o=0;o<8;o++){this.kgl.bindFramebuffer(n&&o>=7?null:e),this.uniforms.uTexture=t,this.uniforms.uRadius=(7-o)*(void 0!==r?r:this.radius),this.uniforms.uIsHorizontal=o%2==0,this.kgl.clear(),f(b(u.prototype),"draw",this).call(this);var i=e;e=t,t=i}}}]),u}();exports.default=d;
},{"../program.js":"XCtE","../shaders/postprocessing/blur.frag":"f5B0"}],"aPJu":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uResolution;\nuniform sampler2D uTexture;\nuniform float uThreshold;\n\nvoid main() {\n  vec2 uv = gl_FragCoord.st / uResolution;\n  vec4 color = texture2D(uTexture, uv);\n  if (color.a == 0. || length(color.rgb) < uThreshold * 1.732) discard;\n  gl_FragColor = color;\n}\n";
},{}],"dk7k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("../program.js")),e=r(require("../shaders/postprocessing/specular.frag"));function r(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=c(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function c(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=h();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(r){l(u,t.default);var n=s(u);function u(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,u);var f=r.threshold,i=void 0===f?.5:f,c={fragmentShader:e.default,uniforms:{uTexture:"framebuffer",uThreshold:i},hasCamera:!1,hasLight:!1};return n.call(this,t,c)}return f(u,[{key:"draw",value:function(t,e,r){this.kgl.bindFramebuffer(e),this.uniforms.uTexture=t,void 0!==r&&(this.uniforms.uThreshold=r),this.kgl.clear(),i(d(u.prototype),"draw",this).call(this)}}]),u}();exports.default=b;
},{"../program.js":"XCtE","../shaders/postprocessing/specular.frag":"aPJu"}],"gGhW":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uResolution;\nuniform sampler2D uTexture;\n\nvoid main() {\n  gl_FragColor = texture2D(uTexture, gl_FragCoord.st / uResolution);\n}\n";
},{}],"iAUv":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uResolution;\nuniform sampler2D uSpecular;\n\nconst float brightness = 0.7;\nconst float spread = 0.3;\n\nvoid main() {\n  vec2 uv = gl_FragCoord.st / uResolution;\n  vec4 specularColor = texture2D(uSpecular, uv);\n  specularColor.rgb = pow(specularColor.rgb, vec3(1. - brightness));\n  specularColor.a = pow(specularColor.a, 1. - spread);\n  gl_FragColor = specularColor;\n  // gl_FragColor = vec4(vec3(specularColor.a), 1.); // * debug\n  // gl_FragColor = vec4(texture2D(uSpecular, uv).rgb, 1.); // * debug\n}\n";
},{}],"AvFv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("../program.js")),t=u(require("./specular.js")),r=u(require("./blur.js")),o=u(require("../shaders/template/texture.frag")),n=u(require("../shaders/postprocessing/bloom.frag"));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var o=s(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=m();return function(){var r,o=v(e);if(t){var n=v(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(u){p(a,e.default);var f=d(a);function a(u){var c;i(this,a);var l={fragmentShader:n.default,uniforms:{uSpecular:"framebuffer"},isAdditive:!0,hasCamera:!1,hasLight:!1};return(c=f.call(this,u,l)).bloomSpecular=u.createEffect(t.default,{threshold:.3}),c.bloomBlur=u.createEffect(r.default),c.bloomBase=u.createEffect(e.default,{fragmentShader:o.default,uniforms:{uTexture:"framebuffer"}}),c.radius=.4,c}return c(a,[{key:"draw",value:function(e,t,r,o,n){this.bloomSpecular.draw(e,t),this.bloomBlur.draw(t,r,void 0!==o?o:this.radius),this.kgl.bindFramebuffer(n?null:r);var u=this.bloomBase;u.uniforms.uTexture=e,u.draw(),this.uniforms.uSpecular=t,l(v(a.prototype),"draw",this).call(this)}}]),a}();exports.default=g;
},{"../program.js":"XCtE","./specular.js":"dk7k","./blur.js":"qTOb","../shaders/template/texture.frag":"gGhW","../shaders/postprocessing/bloom.frag":"iAUv"}],"KuNS":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uTexture;\nuniform vec2 uResolution;\nuniform float uStrength;\nuniform vec2 uCenter;\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nconst float nFrag = 1. / 30.;\n\nvoid main () {\n  vec2 tFrag = 1. / uResolution;\n  vec3 destColor = vec3(0.);\n  float randomValue = random(vec2(12.9898, 78.233));\n  vec2 fc = gl_FragCoord.st;\n  vec2 fcc = fc - uCenter;\n  float totalWeight = 0.;\n\n  for (float i = 0.; i <= 30.; i++) {\n    float percent = (i + randomValue) * nFrag;\n    float weight = percent - percent * percent;\n    vec2 t = fc - fcc * percent * uStrength * nFrag;\n    destColor += texture2D(uTexture, t * tFrag).rgb * weight;\n    totalWeight += weight;\n  }\n  gl_FragColor = vec4(destColor / totalWeight, 1.);\n}\n";
},{}],"CLIj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("../program.js")),e=r(require("../shaders/postprocessing/zoomblur.frag"));function r(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),t}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=c(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function c(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=h();return function(){var r,n=b(t);if(e){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(r){l(u,t.default);var n=s(u);function u(t){o(this,u);var r={fragmentShader:e.default,uniforms:{uTexture:"framebuffer",uStrength:5,uCenter:[t.canvas.width/2,t.canvas.height/2]}};return n.call(this,t,r)}return f(u,[{key:"draw",value:function(t,e,r,n,o){this.kgl.bindFramebuffer(o?null:e),this.uniforms.uTexture=t,void 0!==r&&(this.uniforms.uStrength=r),void 0!==n&&(this.uniforms.uCenter=n),this.kgl.clear(),i(b(u.prototype),"draw",this).call(this)}}]),u}();exports.default=d;
},{"../program.js":"XCtE","../shaders/postprocessing/zoomblur.frag":"KuNS"}],"RR3l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("../program.js")),t=u(require("./blur.js")),r=u(require("./specular.js")),o=u(require("./zoomblur.js")),n=u(require("../shaders/template/texture.frag"));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var o=s(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=m();return function(){var r,o=v(e);if(t){var n=v(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(u){p(i,e.default);var f=d(i);function i(u){var c;a(this,i);var l={fragmentShader:n.default,uniforms:{uTexture:"framebuffer"},isAdditive:!0};return(c=f.call(this,u,l)).godraySpecular=u.createEffect(r.default,{threshold:.75}),c.godrayZoomblur=u.createEffect(o.default),c.godrayBlur=u.createEffect(t.default),c.godrayBase=u.createEffect(e.default,{fragmentShader:n.default,uniforms:{uTexture:"framebuffer"}}),c.radius=.02,c}return c(i,[{key:"draw",value:function(e,t,r,o,n,u,f){this.godraySpecular.draw(e,r),this.godrayZoomblur.draw(r,t,o,n),this.godrayBlur.draw(t,r,void 0!==u?u:this.radius),this.kgl.bindFramebuffer(f?null:r);var a=this.godrayBase;a.uniforms.uTexture=e,a.draw(),this.uniforms.uTexture=t,l(v(i.prototype),"draw",this).call(this)}}]),i}();exports.default=g;
},{"../program.js":"XCtE","./blur.js":"qTOb","./specular.js":"dk7k","./zoomblur.js":"CLIj","../shaders/template/texture.frag":"gGhW"}],"Ibab":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=u(require("../program.js")),t=u(require("./blur.js")),r=u(require("./specular.js")),o=u(require("./zoomblur.js")),n=u(require("../shaders/template/texture.frag"));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var o=s(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=v();return function(){var r,o=m(e);if(t){var n=m(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(u){p(c,e.default);var f=d(c);function c(e){var u;i(this,c);var a={fragmentShader:n.default,uniforms:{uTexture:"framebuffer"},isAdditive:!0};return(u=f.call(this,e,a)).godraySpecular=e.createEffect(r.default,{threshold:.75}),u.godrayZoomblur=e.createEffect(o.default),u.godrayBlur=e.createEffect(t.default),u.radius=.02,u}return a(c,[{key:"draw",value:function(e,t,r,o,n,u,f){this.godraySpecular.draw(e,r),this.godrayZoomblur.draw(r,t,o,n),this.godrayBlur.draw(t,r,void 0!==u?u:this.radius),this.kgl.bindFramebuffer(f?null:r),this.uniforms.uTexture=t,l(m(c.prototype),"draw",this).call(this)}}]),c}();exports.default=g;
},{"../program.js":"XCtE","./blur.js":"qTOb","./specular.js":"dk7k","./zoomblur.js":"CLIj","../shaders/template/texture.frag":"gGhW"}],"gaiZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Bloom",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"Blur",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"Godray",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"GodrayLight",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"Specular",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"Zoomblur",{enumerable:!0,get:function(){return u.default}});var e=l(require("./blur.js")),r=l(require("./specular.js")),t=l(require("./bloom.js")),u=l(require("./zoomblur.js")),o=l(require("./godray.js")),n=l(require("./godrayLight.js"));function l(e){return e&&e.__esModule?e:{default:e}}
},{"./blur.js":"qTOb","./specular.js":"dk7k","./bloom.js":"AvFv","./zoomblur.js":"CLIj","./godray.js":"RR3l","./godrayLight.js":"Ibab"}],"piXn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./kgl.js")),t=n(require("./effects/index.js"));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function n(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var c=i?Object.getOwnPropertyDescriptor(e,u):null;c&&(c.get||c.set)?Object.defineProperty(o,u,c):o[u]=e[u]}return o.default=e,n&&n.set(e,o),o}function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=s(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=v();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(r){l(o,e.default);var n=y(o);function o(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,o),(e=n.call(this,r)).programs={},e.effects={},e.framebuffers={},e.ticks=[];var i=r.programs,c=void 0===i?{}:i,f=r.effects,a=void 0===f?[]:f,s=r.framebuffers,l=void 0===s?[]:s,p=r.framebufferFloats,y=void 0===p?{}:p,h=r.tick,v=r.onBefore,b=r.onResize,m=r.isAutoResize,O=void 0===m||m,g=r.isAutoStart,w=void 0===g||g;switch("function"==typeof h&&e.addTick(h),e.onResize=b,Object.keys(c).forEach(function(t){var r=c[t],n=e.programs[t]=e.createProgram(r);r.isFloats||e.add(n)}),a.forEach(function(r){var n=r.charAt(0).toUpperCase()+r.slice(1);e.effects[r]=e.createEffect(t[n])}),O&&e._initResize(),l.constructor.name){case"Array":l.forEach(function(t){e.createFramebuffer(t)});break;case"Object":Object.keys(l).forEach(function(t){var r=l[t],n=r.width,o=r.height;e.createFramebuffer(t,n,o)})}return Object.keys(y).forEach(function(t){var r=y[t],n=r.width,o=r.height;e.createFramebufferFloat(t,n,o)}),"function"==typeof v&&v(d(e)),w&&e.start(),e}return f(o,[{key:"_initResize",value:function(){this.resize(),this._resize=this.resize.bind(this),window.addEventListener("resize",this._resize)}},{key:"addTick",value:function(e){this.ticks.push(e)}},{key:"start",value:function(){var e,t=this;requestAnimationFrame(function(t){e=t});this.requestID=requestAnimationFrame(function r(n){for(var o=.001*(n-e),i=0;i<t.ticks.length;i++)t.ticks[i](t,o);t.requestID=requestAnimationFrame(r)})}},{key:"stop",value:function(){this.requestID&&(cancelAnimationFrame(this.requestID),this.requestID=null)}},{key:"destroy",value:function(){this.stop(),window.removeEventListener("resize",this._resize),a(b(o.prototype),"destroy",this).call(this)}}]),o}();exports.default=m;
},{"./kgl.js":"gecP","./effects/index.js":"gaiZ"}],"uBxZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={KglAuto:!0};Object.defineProperty(exports,"KglAuto",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return t.default}});var t=o(require("./kgl")),r=o(require("./kglAuto")),u=require("./effects/index.js");function o(e){return e&&e.__esModule?e:{default:e}}Object.keys(u).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||t in exports&&exports[t]===u[t]||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return u[t]}}))});
},{"./kgl":"gecP","./kglAuto":"piXn","./effects/index.js":"gaiZ"}],"P7KZ":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nvoid main () {\n  gl_FragColor = vec4(vec3(0.), 1.);\n}\n";
},{}],"vn2o":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uSize;\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main () {\n  vec2 nPosition = gl_FragCoord.st / uSize * 2. - 1.;\n  vec4 position = vec4(\n    nPosition * uSize,\n    0.,\n    random(nPosition)\n  );\n  gl_FragColor = position;\n}\n";
},{}],"cUPJ":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uSize;\nuniform sampler2D uPrevVelocityTexture;\nuniform sampler2D uPrevPositionTexture;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nvec3 snoiseVec3( vec3 x ){\n\n  float s  = snoise(vec3( x ));\n  float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n  float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n  vec3 c = vec3( s , s1 , s2 );\n  return c;\n\n}\n\nvec3 curlNoise( vec3 p ){\n  \n  const float e = .1;\n  vec3 dx = vec3( e   , 0.0 , 0.0 );\n  vec3 dy = vec3( 0.0 , e   , 0.0 );\n  vec3 dz = vec3( 0.0 , 0.0 , e   );\n\n  vec3 p_x0 = snoiseVec3( p - dx );\n  vec3 p_x1 = snoiseVec3( p + dx );\n  vec3 p_y0 = snoiseVec3( p - dy );\n  vec3 p_y1 = snoiseVec3( p + dy );\n  vec3 p_z0 = snoiseVec3( p - dz );\n  vec3 p_z1 = snoiseVec3( p + dz );\n\n  float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n  float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n  float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\n  const float divisor = 1.0 / ( 2.0 * e );\n  return normalize( vec3( x , y , z ) * divisor );\n\n}\n\nconst float speed = 2.;\nconst float density = 0.007;\nconst float ease = 0.02;\n\nvoid main () {\n  vec2 uv = gl_FragCoord.st / uSize;\n  vec4 velocity = texture2D(uPrevVelocityTexture, uv);\n  vec3 prevPosition = texture2D(uPrevPositionTexture, uv).xyz;\n  velocity.xyz += curlNoise(prevPosition * density) * speed;\n  velocity.xyz *= velocity.w;\n  if (velocity.w > 0.01) {\n    velocity.w -= velocity.w * ease;\n  } else {\n    velocity.w = 1.;\n  }\n  gl_FragColor = velocity;\n}\n";
},{}],"N5wX":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 uSize;\nuniform sampler2D uPrevPositionTexture;\nuniform sampler2D uVelocityTexture;\n\nvoid main () {\n  vec2 uv = gl_FragCoord.st / uSize;\n  vec4 prevPosition = texture2D(uPrevPositionTexture, uv);\n  vec4 velocity = texture2D(uVelocityTexture, uv);\n\n  vec3 position;\n  if (velocity.w == 1.) {\n    vec2 nPosition = uv * 2. - 1.;\n    position = vec3(nPosition * uSize, 0.);\n  } else {\n    position = prevPosition.xyz + velocity.xyz;\n  }\n\n  gl_FragColor = vec4(position, prevPosition.w);\n}\n";
},{}],"zHjc":[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aInstancedUv;\n\nuniform sampler2D uPositionTexture;\nuniform sampler2D uVelocityTexture;\nuniform mat4 uMvpMatrix;\nuniform mat4 uInvMatrix;\nuniform vec3 uLightDirection;\nuniform vec3 uAmbientColor;\nuniform vec3 uEyeDirection;\nuniform float uTime;\n\nvarying vec4 vColor;\n\nmat3 rotateQ(vec3 axis, float rad) {\n    float hr = rad / 2.0;\n    float s = sin( hr );\n    vec4 q = vec4(axis * s, cos( hr ));\n    vec3 q2 = q.xyz + q.xyz;\n    vec3 qq2 = q.xyz * q2;\n    vec2 qx = q.xx * q2.yz;\n    float qy = q.y * q2.z;\n    vec3 qw = q.w * q2.xyz;\n\n    return mat3(\n        1.0 - (qq2.y + qq2.z),  qx.x - qw.z,            qx.y + qw.y,\n        qx.x + qw.z,            1.0 - (qq2.x + qq2.z),  qy - qw.x,\n        qx.y - qw.y,            qy + qw.x,              1.0 - (qq2.x + qq2.y)\n    );\n}\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvec3 hsv(float h, float s, float v) {\n  vec4 t = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(vec3(h) + t.xyz) * 6.0 - vec3(t.w));\n  return v * mix(vec3(t.x), clamp(p - vec3(t.x), 0.0, 1.0), s);\n}\n\nconst float PI = 3.1415926;\n\nconst float PI2 = PI * 2.;\nconst float colorInterval = PI2 * 10.;\nconst float scale = 2.;\nconst float maxScaleRate = 1.4;\nconst float rotationSpeed = 100.;\nconst float minRotationSpeed = 0.1;\n\nvoid main () {\n  vec3 modelPosition = aPosition;\n  vec4 instancedPosition = texture2D(uPositionTexture, aInstancedUv);\n  float randomValue = instancedPosition.w;\n\n  float velocity = texture2D(uVelocityTexture, aInstancedUv).w;\n  float life = smoothstep(0.01, 0.04, velocity);\n\n  float cScale = scale;\n  cScale *= life;\n  cScale *= mix(1., maxScaleRate, (instancedPosition.z - 1.) * 0.01);\n  modelPosition *= cScale;\n\n  vec3 axis = normalize(vec3(\n    random(vec2(randomValue, 0.)),\n    random(vec2(0., randomValue)),\n    random(vec2(randomValue, 1.))\n  ));\n  float radian = PI2 * random(vec2(randomValue));\n  radian += velocity * mix(minRotationSpeed, rotationSpeed, randomValue);\n  mat3 rotate = rotateQ(axis, radian);\n  modelPosition *= rotate;\n\n  vec3 cNormal = normalize(aNormal);\n  cNormal *= rotate;\n  vec3 invLight = normalize(uInvMatrix * vec4(uLightDirection, 0.)).rgb;\n  vec3 invEye = normalize(uInvMatrix * vec4(uEyeDirection, 0.)).rgb;\n  vec3 halfLE = normalize(invLight + invEye);\n  float diffuse = clamp(dot(cNormal, invLight), 0.1, 1.);\n  float specular = pow(clamp(dot(cNormal, halfLE), 0., 1.), 50.);\n\n  float colorNTime = mod(uTime, colorInterval) / colorInterval;\n  float alpha = 1.;\n  vColor = vec4(hsv(colorNTime * PI2, 0.25 + 0.7 * colorNTime, 0.85 + 0.1 * colorNTime), alpha);\n  vColor.rgb *= vec3(diffuse + specular);\n  vColor.rgb += uAmbientColor;\n  vColor.rgb *= mix(0.2, 1., clamp(((instancedPosition + 100.) / 200.).z, 0., 1.));\n  vColor.rgb *= life;\n\n  gl_Position = uMvpMatrix * (vec4(modelPosition + instancedPosition.xyz, 1.));\n}\n";
},{}],"imKV":[function(require,module,exports) {
module.exports="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 vColor;\n\nvoid main () {\n  gl_FragColor = vColor;\n}\n";
},{}],"MF6c":[function(require,module,exports) {
"use strict";var e=s(require("../../../src/index.js")),r=s(require("./shaders/reset-velocity.frag")),a=s(require("./shaders/reset-position.frag")),t=s(require("./shaders/velocity.frag")),i=s(require("./shaders/position.frag")),o=s(require("./shaders/main.vert")),u=s(require("./shaders/main.frag"));function s(e){return e&&e.__esModule?e:{default:e}}for(var n=100,f=100,c=[n,f],d=[],m=0;m<n;m++)for(var l=0;l<f;l++)d.push(m/(n-1),1-l/(f-1));var v=new e.default({clearedColor:[0,0,0,1],hasCamera:!0,hasLight:!0,cameraPosition:[0,0,480],fov:50}),b=v.createProgram({fragmentShader:r.default,isFloats:!0}),h=v.createProgram({fragmentShader:a.default,uniforms:{uSize:c},isFloats:!0}),P=v.createProgram({fragmentShader:t.default,uniforms:{uSize:c,uPrevVelocityTexture:"framebuffer",uPrevPositionTexture:"framebuffer"},isFloats:!0}),g=v.createProgram({fragmentShader:i.default,uniforms:{uSize:c,uPrevPositionTexture:"framebuffer",uVelocityTexture:"framebuffer"},isFloats:!0}),T=v.createProgram({shape:"cube",vertexShader:o.default,fragmentShader:u.default,instancedAttributes:{aInstancedUv:{value:d,size:2}},uniforms:{uPositionTexture:"framebuffer",uVelocityTexture:"framebuffer",uTime:0},isDepth:!0,isTransparent:!0,isAutoAdd:!0});function p(){v.resize()}["velocity0","velocity1","position0","position1"].forEach(function(e){v.createFramebufferFloat(e,n,f)}),p(),window.addEventListener("resize",p);var x,y=0,F=y++%2;function q(e){e*=.001,x=F,F=y++%2;var r="velocity".concat(x),a="position".concat(x),t="velocity".concat(F),i="position".concat(F);v.bindFramebuffer(t),P.updateUniforms({uPrevVelocityTexture:r,uPrevPositionTexture:a}),P.draw(),v.bindFramebuffer(i),g.updateUniforms({uPrevPositionTexture:a,uVelocityTexture:t}),g.draw(),v.unbindFramebuffer(),v.clear(),T.updateUniforms({uPositionTexture:i,uVelocityTexture:t,uTime:e}),T.draw(),requestAnimationFrame(q)}v.bindFramebuffer("velocity".concat(F)),b.draw(),v.bindFramebuffer("position".concat(F)),h.draw(),requestAnimationFrame(q);
},{"../../../src/index.js":"uBxZ","./shaders/reset-velocity.frag":"P7KZ","./shaders/reset-position.frag":"vn2o","./shaders/velocity.frag":"cUPJ","./shaders/position.frag":"N5wX","./shaders/main.vert":"zHjc","./shaders/main.frag":"imKV"}]},{},["MF6c"], null)