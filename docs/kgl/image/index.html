<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>KGL Library Demo - Image</title><link rel="stylesheet" href="/kgl/image.ffec2b1a.css"></head><body> <script id="fs" type="x-shader/x-fragment">
    precision highp float;

    uniform vec2 uResolution;
    uniform sampler2D uImage;
    uniform vec2 uImageResolution;
    uniform float uTime;

    const float PI = 3.1415926;
    const float pSpeed = 1.5;

    vec2 adjustRatio(vec2 uv, vec2 inputResolution, vec2 outputResolution) {
      vec2 ratio = vec2(
        min((outputResolution.x / outputResolution.y) / (inputResolution.x / inputResolution.y), 1.),
        min((outputResolution.y / outputResolution.x) / (inputResolution.y / inputResolution.x), 1.)
      );
      return uv * ratio + (1. - ratio) * 0.5;
    }

    vec2 getZoomedUv(vec2 uv, float zoom, vec2 origin) {
      origin.x = -origin.x;
      uv += origin;
      float scale = 1. / zoom;
      return uv * scale - 0.5 * (scale - 1.);
    }

    void main() {
      vec2 uv = gl_FragCoord.st / uResolution;
      uv.y = 1. - uv.y;
      uv = adjustRatio(uv, uImageResolution, uResolution);

      vec2 uvCenter = uv * 2. - 1.;
      float distortion = min(max(1. / length(uvCenter) * (sin(uTime * pSpeed - PI * 0.5) * 0.5 + 0.5), 0.), 1.);
      distortion = smoothstep(0.6, 0.8, distortion) * smoothstep(1., 0.8, distortion);

      vec2 zoomedUv = getZoomedUv(uv, 0.8, vec2(0.));

      gl_FragColor = texture2D(uImage, mix(uv, zoomedUv, distortion));
      // gl_FragColor = vec4(vec3(distortion), 1.);
    }
  </script> <script src="/kgl/image.4db21e5d.js"></script> </body></html>